name: Deploy Godot Android Game to Play Store.

on:
  workflow_call:
    secrets:
      service-account-json-base64:
        description: >-
          Base64 encoded service account JSON file for Google Play Store
          authentication.
        required: true
    inputs:
      artifact-name:
        type: string
        description: >-
          Name of the artifact to download. Eg. Android
        required: true
      android-package:
        type: string
        description: >-
          Package name of the Android application. Eg. com.example.app
        required: true
      game-name:
        type: string
        description: >-
          Name of the game, used for the artifact name. Eg. MyGame
        required: true

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: ðŸ“¥ Download Build Artifact
        uses: actions/download-artifact@v4
        with:
          name: ${{ inputs.artifact-name }}
          path: build
      
      - name: Deploy Android via composite action
        uses: ./.github/actions/deploy-android
        with:
          artifact-name: ${{ inputs.artifact-name }}
          android-package: ${{ inputs.android-package }}
          game-name: ${{ inputs.game-name }}
          service-account-json-base64: ${{ secrets.service-account-json-base64 }}
